{
  "$schema":"https://vega.github.io/schema/vega-lite/v5.json",
  "title":"World Happiness 2018 to 2022",
  "width":800,
  "height":600,
  "projection":{
      "type":"equalEarth"
  },
  "params":[
      {
          "name":"Year_selection",
          "value":2022,
          "bind":{
              "input":"range",
              "min":2018,
              "max":2022,
              "step":1,
              "name":"Year:  "
          }
      }
  ],
  "layer":[
      {
          "data":{
              "url":"https://raw.githubusercontent.com/JiazhouLiu/FIT3179/main/VegaLite/3_choropleth_map/js/ne_110m_admin_0_countries.topojson",
              "format":{
                  "type":"topojson",
                  "feature":"ne_110m_admin_0_countries"
              }
          },
          "transform":[
              {
                  "calculate":"'Data is not available in ' + datum.properties.NAME",
                  "as":"note"
              }
          ],
          "mark":{
              "type":"geoshape",
              "fill":"#ddd",
              "stroke":"white",
              "strokeWidth":1
          },
          "encoding":{
              "tooltip":{
                  "field":"note"
              }
          }
      },
      {
          "data":{
              "url":"happinessScrapped.csv"
          },
          "transform":[
              {
                  "lookup":"Country",
                  "from":{
                      "data":{
                          "url":"https://raw.githubusercontent.com/JiazhouLiu/FIT3179/main/VegaLite/3_choropleth_map/js/ne_110m_admin_0_countries.topojson",
                          "format":{
                              "type":"topojson",
                              "feature":"ne_110m_admin_0_countries"
                          }
                      },
                      "key":"properties.NAME"
                  },
                  "as":"geo"
              },
              {
                  "filter":"datum.Year == Year_selection"
              }
          ],
          "mark":{
              "type":"geoshape",
              "stroke":"#f5efef",
              "strokeWidth":0.5
          },
          "encoding":{
              "shape":{
                  "field":"geo",
                  "type":"geojson"
              },
              "color":{
                  "field":"Happiness Score",
                  "type":"quantitative",
                  "scale":{
                      "scheme":"reds"
                  }
              },
              "tooltip":[
                  {
                      "field":"Country",
                      "type":"nominal",
                      "title":"Country"
                  },
                  {
                      "field":"Happiness Score",
                      "type":"quantitative",
                      "format":".2f"
                  },
                  {
                    "field":"Year",
                    "type":"quantitative"
                    
                }


              ]
          }
      }
  ],
  "config":{

  }
}
